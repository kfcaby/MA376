fish %>% ggplot(aes(x = fish, y = omega.3)) + geom_boxplot()
fish = fish %>% mutate(mean1 = mean(omega.3))
SST = sum((fish$omega.3-fish$mean1)^2)
fish = fish %>% group_by(fish) %>% mutate(mean2 = mean(omega.3))
#SSE
SSE = sum((fish$omega.3 - fish$mean2)^2)
#SSR
SSR = SST - SSE
#R^2
R2 = SSR/SST
model = lm(omega.3 ~ fish, data = fish)
anova(model)
m = 5000
rsquared = c()
fish.sim = fish %>% mutate(fish.sim = sample(fish))
fish.sim = fish.sim %>% group_by(fish.sim) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((fish.sim$omega.3 - fish.sim$mean2.sim)^2)
rsquared = 1-SSE/SST
rsquared = 1-SSE.sim/SST
fish.sim = fish %>% mutate(fish.sim = sample(fish))
fish.sim = fish.sim %>% group_by(fish.sim) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((fish.sim$omega.3 - fish.sim$mean2.sim)^2)
rsquared = 1-SSE.sim/SST
fish.sim = fish %>% mutate(fish.sim = sample(fish))
fish.sim = fish.sim %>% group_by(fish.sim) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((fish.sim$omega.3 - fish.sim$mean2.sim)^2)
rsquared = 1-SSE.sim/SST
fish.sim = fish %>% mutate(fish.sim = sample(fish))
fish.sim = fish.sim %>% group_by(fish.sim) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((fish.sim$omega.3 - fish.sim$mean2.sim)^2)
rsquared = 1-SSE.sim/SST
fish.sim = fish %>% mutate(fish.sim = sample(fish))
fish.sim = fish %>% mutate(fish.sim = sample(fish$fish))
fish.sim = fish.sim %>% group_by(fish.sim) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((fish.sim$omega.3 - fish.sim$mean2.sim)^2)
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t",
header = TRUE)
diet %>% group_by(fish) %>% summarise(mean(omega.3),
sd(omega.3),
n())
diet %>% ggplot(aes(y = omega.3)) + geom_boxplot()
diet = diet %>% filter(omega.3 < 0.08)
diet %>% ggplot(aes(x = fish, y = omega.3)) + geom_boxplot()
library(tidyverse)
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t",
header = TRUE)
#descriptive statistics
diet %>% group_by(fish) %>% summarise(mean(omega.3),
sd(omega.3),
n())
diet %>% ggplot(aes(y = omega.3)) + geom_boxplot()
diet = diet %>% filter(omega.3 < 0.08)
diet %>% ggplot(aes(x = fish, y = omega.3)) + geom_boxplot()
diet = diet %>% mutate(mean1 = mean(omega.3))
SST = sum((diet$omega.3-diet$mean1)^2)
diet = diet %>% group_by(fish) %>% mutate(mean2 = mean(omega.3))
#SSE
SSE = sum((diet$omega.3 - diet$mean2)^2)
#SSR
SSR = SST - SSE
#R^2
R2 = SSR/SST
model = lm(omega.3 ~ fish, data = diet)
anova(model)
m = 5000
rsquared = c()
diet.sim = diet %>% mutate(fish.sim = sample(fish))
View(diet.sim)
diet.sim = diet %>% mutate(fish.sim = sample(fish))
diet.sim = diet.sim %>% group_by(fish.sim) %>% mutate(mean2.sim = mean(omega.3))
sample(diet$fish)
diet %>% mutate(fish.sim = sample(fish))
sim.diet = diet %>% mutate(sim.fish = sample(fish))
View(sim.diet)
sim.diet = diet %>% mutate(sim.fish = sample(fish, replace = FALSE))
sample(diet$fish)
diet$sim.fish = sample(diet$fish)
View(diet)
diet = diet %>% group_by(sim.fish) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((diet$omega.3 - diet$mean2.sim)^2)
rsquared = 1-SSE.sim/SST
for(i in 1:m){
diet$sim.fish = sample(diet$fish)
diet = diet %>% group_by(sim.fish) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((diet$omega.3 - diet$mean2.sim)^2)
rsquared[i] = 1-SSE.sim/SST
}
hist(rsquared)
hist(rsquared, breaks)
hist(rsquared, breaks = 50)
sum(rsquared > R2)/m
plot(df(seq(0,0.6,0.01), 4, 22))
x = seq(0,0.6,0.01)
plot(x, df(x,4,22))
x = seq(0,0.6,0.01)
plot(x, df(x,4,22))
df(x,4,22)
plot(x, df(x,4,22))
anova(model)
#Fstat
Fstat = (SSR/4)/(SSE/22)
summary(model)
for(i in 1:m){
diet$sim.fish = sample(diet$fish)
diet = diet %>% group_by(sim.fish) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((diet$omega.3 - diet$mean2.sim)^2)
rsquared[i] = 1-SSE.sim/SST
fstat.sim[i] = ((SST-SSE.sim)/4)/(SSE.sim/22)
}
fstat.sim = c()
for(i in 1:m){
diet$sim.fish = sample(diet$fish)
diet = diet %>% group_by(sim.fish) %>% mutate(mean2.sim = mean(omega.3))
SSE.sim = sum((diet$omega.3 - diet$mean2.sim)^2)
rsquared[i] = 1-SSE.sim/SST
fstat.sim[i] = ((SST-SSE.sim)/4)/(SSE.sim/22)
}
hist(fstat.sim)
x = seq(0,10,0.1)
plot(x, df(x,4,22))
plot(x, df(x,4,22), type = "l")
hist(fstat.sim)
plot(x, df(x,4,22), type = "l")
1 - pf(5.62, 4, 22)
summary(model)
1 - pf(5.62, 4, 22)
library(tidyverse)
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t",
header = TRUE)
diet = read_csv(file = "www.isi-stats.com/isi2/data/FishOmega3.txt")
library(tidyverse)
diet = read_csv(file = "www.isi-stats.com/isi2/data/FishOmega3.txt")
diet = read_csv(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt")
diet
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t")
View(diet)
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t",
header = TRUE)
View(diet)
#summary Statistics
diet %>% group_by(fish) %>% summarise(mean(omega.3),
sd(omega.3),
n())
diet %>% ggplot(aes(y = omega.3)) + geom_boxplot()
diet %>% ggplot(aes(y = omega.3)) + geom_boxplot() +
theme_classic()
diet %>% ggplot(aes(X = fish,y = omega.3)) + geom_boxplot() +
theme_classic()
diet %>% ggplot(aes(x = fish,y = omega.3)) + geom_boxplot() +
theme_classic()
diet %>% ggplot(aes(y = fish,x = omega.3)) + geom_boxplot() +
theme_classic()
diet %>% ggplot(aes(x = fish,y = omega.3)) + geom_boxplot() +
theme_classic() + coord_flip()
diet %>% ggplot(aes(x = fish,y = omega.3)) + geom_boxplot() +
theme_classic() + coord_flip() + labs(title = "Test")
diet %>% ggplot(aes(x = fish,y = omega.3)) + geom_boxplot() +
theme_classic() + coord_flip() + labs(title = "Boxplot of Omega3 by fish consumption")
diet = diet %>% mutate(mean1 = mean(omega.3))
SST = sum((diet$omega.3 - diet$mean1)^2)
#Equivalent to single mean model
model_onemean = lm(omega.3 ~ 1, data = diet)
diet %>% ggplot(aes(x = fish,y = omega.3)) + geom_boxplot() +
theme_classic() +  labs(title = "Boxplot of Omega3 by fish consumption")
diet = diet %>% group_by(fish) %>% mutate(meanSep = mean(omega.3))
SSE = sum((diet$omega.3 - diet$meanSep)^2)
R2 = 1 - SSE/SST
library(tidyverse)
Replications = NULL
Num.Reps = 1000
72/500
1/6
Replications = NULL
Num.Reps = 1000
Sample.Size = 500
Null.Prob = 1/6
Sample.Stat = 72/500
for (i in 1:Num.Reps) {
Trials = sample(x = c(1, 0), size = Sample.Size, prob = c(Null.Prob, 1 -
Null.Prob), replace = TRUE)
Proportion = sum(Trials)/Sample.Size
Replications = rbind(Replications, data.frame(Proportion))
}
Replications %>% ggplot(aes(x = Proportion)) + geom_histogram(fill = "cadetblue",
color = "black") + labs(x = "Proportion of Success", y = "Count") + geom_vline(xintercept = Sample.Stat,
color = "red")
Replications
Replications$Proportion <= Sample.Stat
sum(Replications$Proportion <= Sample.Stat)
sum(Replications$Proportion <= Sample.Stat)/Num.Reps
mean(Replications$Proportion)
sd(Replications$Proportion)
(72/500 - 1/6)/0.016
prop.test(x = 72, n = 500, p = 1/6, alternative = "less",
correct = FALSE)
candidates = data.frame(Year = c(2016,2016),
District = c("Adams",
"Adams"),
Candidate = c("Clinton", "Trump"),
Votes = c(20,30))
View(candidates)
library(tidyverse)
candidates %>% spread(key = Candidate, value = Votes)
candidates = data.frame(Year = c(2016,2016,2016,2016),
District = c("Adams",
"Adams",
"Ashland",
"Ashland"),
Candidate = c("Clinton", "Trump",
"Clinton","Trump"),
Votes = c(20,30,40,35))
candidates %>% spread(key = Candidate, value = Votes)
candidate_long = candidates %>% spread(key = Candidate, value = Votes)
candidate_long %>% mutate(clintonPercent = Clinton/(Clinton + Trump)*100)
install.packages('fivethirtyeight')
library(fivethirtyeight)
tarantino
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t",
header = TRUE)
#descriptive statistics
diet %>% group_by(fish) %>% summarise(mean(omega.3),
sd(omega.3),
n())
diet %>% ggplot(aes(y = omega.3)) + geom_boxplot()
diet = diet %>% filter(omega.3 < 0.08)
diet %>% ggplot(aes(x = fish, y = omega.3)) + geom_boxplot()
diet = diet %>% mutate(mean1 = mean(omega.3))
SST = sum((diet$omega.3-diet$mean1)^2)
diet = diet %>% group_by(fish) %>% mutate(mean2 = mean(omega.3))
#SSE
SSE = sum((diet$omega.3 - diet$mean2)^2)
#SSR
SSR = SST - SSE
#R^2
R2 = SSR/SST
#Fstat
Fstat = (SSR/4)/(SSE/22)
model = lm(omega.3 ~ fish, data = diet)
anova(model)
summary(model)
model = lm(omega.3 ~ fish, data = diet)
anova(model)
aov(model)
pairwise.t.test(diet$omega.3, diet$fish)
summary = diet %>% group_by(fish) %>% summarise(mean(omega.3), sd(omega.3))
summary
summary = diet %>% group_by(fish) %>% summarise(mean(omega.3), sd(omega.3),n(
))
summary
(0.0404 - 0.377) - 2*(0.804 * sqrt(1/6 + 1/5))
(0.0404 - 0.377) - 2*(0.804 * sqrt(1/6 + 1/6))
(0.0404 - 0.377) + 2*(0.804 * sqrt(1/6 + 1/6))
install.packages('pairwiseCI')
library(pairwiseCI)
pairwiseCI(omega.3 ~ fish, data = diet)
pairwiseCI(omega.3 ~ fish, data = diet, pool.sd = TRUE)
pairwiseCI(omega.3 ~ fish, data = diet, pool.sd = TRUE, p.adjust.methods = "none")
qt(0.975,5)
qt(0.975,30)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
diet = read.table(file = "http://www.isi-stats.com/isi2/data/FishOmega3.txt",
sep = "\t",
header = TRUE)
#descriptive statistics
diet %>% group_by(fish) %>% summarise(mean(omega.3),
sd(omega.3),
n())
diet %>% ggplot(aes(y = omega.3)) + geom_boxplot()
diet = diet %>% filter(omega.3 < 0.08)
diet %>% ggplot(aes(x = fish, y = omega.3)) + geom_boxplot()
diet = diet %>% mutate(mean1 = mean(omega.3))
SST = sum((diet$omega.3-diet$mean1)^2)
diet = diet %>% group_by(fish) %>% mutate(mean2 = mean(omega.3))
#SSE
SSE = sum((diet$omega.3 - diet$mean2)^2)
#SSR
SSR = SST - SSE
#R^2
R2 = SSR/SST
#Fstat
Fstat = (SSR/4)/(SSE/22)
#Question: when is the Fstat big?
model = lm(omega.3 ~ fish, data = diet)
anova(model)
summary(model)
model = lm(omega.3 ~ fish, data = diet)
anova(model)
m = 5000
rsquared = c() #vector for simulated R2
fstat.sim = c() #vector for simulated Fstat
#Simulation
for(i in 1:m){
diet$sim.fish = sample(diet$fish) #shuffle fish categories
diet = diet %>% group_by(sim.fish) %>% mutate(mean2.sim = mean(omega.3)) #calculate new means
SSE.sim = sum((diet$omega.3 - diet$mean2.sim)^2) #calculate new SSE
rsquared[i] = 1-SSE.sim/SST #calculate new R2; Question: why don't we calculate SST everytime
fstat.sim[i] = ((SST-SSE.sim)/4)/(SSE.sim/22) #calculate Fstat
}
#Calculate p-value for R2 = 0.51
hist(rsquared, breaks = 50)
sum(rsquared > R2)/m
#Calculate p-value for Fstat = 5.62
hist(fstat.sim)
SSE
summary = diet %>%group_by(fish) %>% summarise(mean = mean(omega.3),
sd = sd(omega.3),
n = n())
summary
View(diet)
summary = diet %>%group_by(fish) %>%
summarise(mean =mean(omega.3),
sd = sd(omega.3),
n = n(),
residuals2 = sum((omega.3-mean2)^2)
)
summary
summary %>% mutate(pooledSD = sqrt(sum(residuals2)/26))
summary = summary %>% mutate(pooledSD = sqrt(sum(residuals2)/26))
qt(0.975,n-1)
qt(0.975,5)
#calculate confidence interval
summary = summary %>% mutate(LB = mean - qt(0.975,n-1)*pooledSD)
summary
summary = summary %>% mutate(UB = mean + qt(0.975,n-1)*pooledSD)
summary
summary = summary %>% mutate(pooledSD = sqrt(sum(residuals2)/(27-5)))
#calculate confidence interval
summary = summary %>% mutate(LB = mean - qt(0.975,n-1)*pooledSD)
summary = summary %>% mutate(UB = mean + qt(0.975,n-1)*pooledSD)
summary
diet
#calculate confidence interval
summary = summary %>% mutate(LB = mean - qt(0.975,n-1)*pooledSD/sqrt(n))
summary = summary %>% mutate(UB = mean + qt(0.975,n-1)*pooledSD/sqrt(n))
summary
#calculate confidence interval
summary = summary %>% mutate(LB = mean - qt(0.975,26)*pooledSD/sqrt(n))
summary = summary %>% mutate(UB = mean + qt(0.975,26)*pooledSD/sqrt(n))
summary
#calculate confidence interval
summary = summary %>% mutate(LBmean = mean - qt(0.975,26)*pooledSD/sqrt(n))
summary = summary %>% mutate(UBmean = mean + qt(0.975,26)*pooledSD/sqrt(n))
#calculate prediction interval
summary = summary %>% mutate(LBprediction = mean - qt(0.975,26)*pooledSD*sqrt(1+1/n))
summary = summary %>% mutate(UBprediction = mean + qt(0.975,26)*pooledSD*sqrt(1+1/n))
summary
summary
power.t.test(n = 18, delta = 1, sd = 2, power = NULL, type = "one.sample", alternative = "two.sided")
power.t.test(n = NULL, delta = 1, sd = 2, power = 0.80, type = "one.sample", alternative = "two.sided")
install.packages('pwr')
library(pwr)
R2 = 0.1
#Cohen's f statistic
f = sqrt(R2/1-R2)
#Cohen's f statistic
f = sqrt(R2/(1-R2))
pwr.anova.test(k = 5, n = 10, f = f, power = NULL)
R2 = 0.3
#Cohen's f statistic
f = sqrt(R2/(1-R2))
pwr.anova.test(k = 5, n = 10, f = f, power = NULL)
pwr.anova.test(k = NULL, n = 10, f = f, power = 0.80)
f = 5
dfModel = 5
dfResidual = 35
x = seq(0,10, by = 0.1)
pf(x,dfModel, dfResidual)
plot(x,pf(x,dfModel, dfResidual))
plot(x,df(x,dfModel, dfResidual))
1 - pf(f,dfModel, dfResidual)
x = seq(-5,5, by = 0.1)
n = 30
x = seq(-5,5, by = 0.1)
plot(x,dt(x,n-1))
qt(0.975,n-1)
power.t.test(n = 300, delta = 0.33, sd = 0.75, power = NULL, type = "two.sample", alternative = "two.sided")
power.t.test(n = NULL, delta = 0.33, sd = 0.75, power = 0.80, type = "two.sample", alternative = "two.sided")
power.t.test(n = 150, delta = 0.33, sd = 0.75, power = NULL, type = "two.sample", alternative = "two.sided")
read.table(file = "https://github.com/kfcaby/MA376/blob/master/Driver%20Example/driverData")
read.table(file = "https://github.com/kfcaby/MA376/Driver Example/driverData")
pF(0.5361,3,89)
pf(0.5361,3,89)
pf(0.5361,3,89, lower.tail = FALSE)
qf(4,3,89, lower.tail = FALSE)
qf(0.05,3,89, lower.tail = FALSE)
power.t.test(n = 16, delta = 2, sd = 1, power = NULL,
type = "two.sample",
alternative = "two.sided")
power.t.test(n = NULL, delta = 2, sd = 1, power = 0.80,
type = "two.sample",
alternative = "two.sided")
power.t.test(n = NULL, delta = 0.5, sd = 1, power = 0.80,
type = "two.sample",
alternative = "two.sided")
library(pwr)
install.packages('pwr')
library(pwr)
R2 = 0.3
pwr.anova.test(groups = 5, n = 6, f = sqrt(R2/(1-R2)),
power = NULL)
pwr.anova.test(k = 5, n = 6, f = sqrt(R2/(1-R2)),
power = NULL)
library(tidyverse)
drivers = read.table(file = "Driver Example/driverData")
View(drivers)
drivers = read.table(file = "Driver Example/driverData",
header = TRUE)
t.test(drivers$Facebook, drivers$Instagram)
t.test(drivers$Facebook, drivers$Instagram,
paired = FALSE)
t.test(drivers$Facebook, drivers$Instagram,
paired = TRUE)
t.test(drivers$Facebook - drivers$Instagram)
drivers %>% gather(key = "condition", value = "time",
-participant)
drivers_long = drivers %>% gather(key = "condition", value = "time",
-participant)
drivers_long %>% ggplot(aes(x = time)) + geom_dotplot()
drivers_long %>% ggplot(aes(x = time)) + geom_dotplot(method = "histodot")
drivers_long %>% ggplot(aes(x = time)) + geom_dotplot() + coord_trans(y = n())
drivers_long %>% ggplot(aes(x = time)) + geom_dotplot() + coord_trans(y = nrow(drivers_long))
drivers_long %>% ggplot(aes(x = time, y = count())) + geom_dotplot() + coord_trans(y = )
drivers_long %>% ggplot(aes(y = time)) + geom_dotplot() + coord_trans(y = )
drivers_long %>% ggplot(aes(x = time, y = time)) + geom_dotplot() + coord_trans(y = )
drivers_long %>% ggplot(aes(x = time)) + geom_dotplot() + coord_trans(y = )
drivers_long %>% ggplot(aes(x = time))
plot = drivers_long %>% ggplot(aes(x = time))
head(drivers_long)
(110^2)/50
var = (110^2)/50
pnorm(125,120,sqrt(var)) - pnorm(100,120,sqrt(var))
sqrt(var)
50*100
50*120
50*110^2
1-pnorm(150,6000,sqrt(605000))
bulbs = c(12,15,37,38,42,56,63,80,100,
117,119,124,127,156,175,324)
for(i in 1:r){
means[i] = mean(sample(bulbs, replace = TRUE))
}
r = 5000
means = c()
for(i in 1:r){
means[i] = mean(sample(bulbs, replace = TRUE))
}
#confidence interval
quantile(means,c(0.025,0.975))
sds = c()
for(i in 1:r){
means[i] = mean(sample(bulbs, replace = TRUE))
sds[i] = sd(sample(bulbs, replace = TRUE))
}
quantile(sds,c(0.025,0.975))
sd(bulbs)
t = (5.24-5.25)/(0.048/sqrt(45))
pt(t,44)
t = (5.24-5.25)/(0.048/sqrt(100))
pt(t,44)
pt(t,99)
data = data.frame(August = c(55,40,17,40,36,39,62,60),
December = c(70,59,35,68,45,70,63,75))
t.test(data$August,data$December, paired = TRUE,
mu = 10, alternative = "greater")
t.test(data$August,data$December, paired = TRUE,
mu = -10, alternative = "greater")
t.test(data$December,data$August, paired = TRUE,
mu = 10, alternative = "greater")
getwd()
setwd("../../Desktop")
survey = read_csv(file = "Pew_Research_Survey.csv")
survey
View(survey)
survey = read_csv(file = "Pew_Research_Survey.csv") %>%
select(SM7_35, F_PARTY_FINAL)
survey = read_csv(file = "Pew_Research_Survey.csv")
survey = survey %>% select(SM7_W35,F_PARTY_FINAL)
summary = survey %>% group_by(F_PARTY_FINAL) %>%
count()
summary
summary = survey %>% group_by(F_PARTY_FINAL) %>%
summarise(meanSM7 = mean(SM7_W35), n = n())
summary
survey = read_csv(file = "Pew_Research_Survey.csv")
survey = survey %>% select(SM7_W35,F_PARTY_FINAL,
F_EDUCCAT_FINAL)
summary = survey %>% group_by(F_PARTY_FINAL, F_EDUCCAT_FINAL) %>%
summarise(meanSM7 = mean(SM7_W35), n = n())
summary
survey = survey %>%
mutate(binary_likely = case_when(SM7_W35 %in% c(1:2) ~ "likely",
SM7_W35 %in% c(3:4) ~ "notlikely"))
summary = survey %>% group_by(F_PARTY_FINAL) %>%
count(binary_likely)
summary
unique(survey$SM7_W35)
survey = survey %>% filter(SM7_W35 != 99) %>%
mutate(binary_likely = case_when(SM7_W35 %in% c(1:2) ~ "likely",
SM7_W35 %in% c(3:4) ~ "notlikely"))
summary = survey %>% group_by(F_PARTY_FINAL) %>%
count(binary_likely)
unique(survey$SM7_W35)
summary
