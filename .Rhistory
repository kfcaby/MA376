sd(Sled))
sum(acft$blockEffect)
lm.adj = lm(Sled.adj ~ Surface, data = acft)
anova(lm.adj)
adj.lm = lm(Sled ~ Surface + factor(Participant), data = acft)
summary(adj.lm)
anova(adj.lm)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
acft = read_csv("https://raw.githubusercontent.com/nick3703/MA376/master/ACFT.csv")
acft %>% ggplot(aes(x = Surface, y = Sled)) + geom_boxplot()
contrasts(acft$Participant) = contr.sum
acft$Participant = factor(acft$Participant)
contrasts(acft$Participant) = contr.sum
adj.mod = lm(Sled ~ Surface + Participant, data = acft)
summary(adj.mod)
cred = read_csv(file = "http://www.isi-stats.com/isi2/data/CorporateCredibility.txt")
library(tidyverse)
cred = read_csv(file = "http://www.isi-stats.com/isi2/data/CorporateCredibility.txt")
cred = read.table(file = "http://www.isi-stats.com/isi2/data/CorporateCredibility.txt",
header = TRUE)
cred
cred %>% group_by(Treatments) %>% summarise(mean(PI), sd(PI), n())
mean(cred$PI)
cred$Endorser = factor(cred$Endorser)
cred$CorpCred = factor(cred$CorpCred)
contrasts(cred$Endorser) = contr.sum
contrasts(concred$CorpCred) = contr.sum
contrasts(cred$CorpCred) = contr.sum
cred %>% ggplot(aes(x = Treatments, y = PI)) + geom_boxplot()
oneway.lm = lm(PI ~ CorpCred + Endorser)
oneway.lm = lm(PI ~ CorpCred + Endorser, data = cred)
summary(oneway.lm)
anova(oneway.lm)
oneway.lm = lm(PI ~ Treatments, data = cred)
summary(oneway.lm)
anova(oneway.lm)
twoway.lm = lm(PI ~ CorpCred + Endorser, data = cred)
summary(twoway.lm)
anova(oneway.lm)
anova(twoway.lm)
residuals(twoway.lm)
cred$residuals.twoway = residuals(twoway.lm)
cred$fitted.twoway = fitted.values(twoway.lm)
cred %>% ggplot(aes(x = residuals.twoway)) + geom_histogram()
cred %>% ggplot(aes(x = fitted.twoway, y = residuals.twoway)) + geom_point()
library(tidyverse)
cred = read.table(file = "http://www.isi-stats.com/isi2/data/CorporateCredibility.txt",
header = TRUE)
cred %>% group_by(Treatments) %>% summarise(mean(PI), sd(PI), n())
cred %>% ggplot(aes(x = Treatments, y = PI)) + geom_boxplot()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
cred = read.table(file = "http://www.isi-stats.com/isi2/data/CorporateCredibility.txt",
header = TRUE)
cred = read.table(file = "http://www.isi-stats.com/isi2/data/CorporateCredibility.txt",
header = TRUE)
cred %>% group_by(Treatments) %>% summarise(mean(PI), sd(PI), n())
cred$Endorser = factor(cred$Endorser)
cred$CorpCred = factor(cred$CorpCred)
contrasts(cred$Endorser) = contr.sum
contrasts(cred$CorpCred) = contr.sum
contrasts(cred$Endorser) = contr.sum
View(cred)
oneway.lm = lm(PI ~ Treatments, data = cred)
summary(oneway.lm)
twoway.lm = lm(PI ~ Endorser + CorpCred, data = cred)
summary(twoway.lm)
summary(oneway.lm)
summary(twoway.lm)
contrasts(twoway.lm)
names(twoway.lm)
twoway.lm$xlevels
summary(twoway.lm)
cred %>% group_by(Endorser,CorpCred) %>% summarise(mean = mean(PI))
cred %>% group_by(Endorser,CorpCred) %>% summarise(mean = mean(PI)) %>% mutate(meanGrand = mean(mean))
cred %>% group_by(Endorser,CorpCred) %>% summarise(mean = mean(PI))
predict(twoway.lm, data = cred)
cred %>% group_by %>% mutate(prediction = predict(twoway.lm, data = cred))
cred %>% group_by() %>% mutate(prediction = predict(twoway.lm, data = cred))
cred %>% group_by(Endorser,CorpCred) %>% summarise(mean = mean(PI))
cred %>% group_by(Endorser,CorpCred) %>% summarise(mean = mean(PI))
cred %>% group_by() %>% mutate(prediction = predict(twoway.lm, data = cred))
anova(twoway.lm)
summary(lm(PI ~ Endorser, data = cred))
summary(twoway.lm)
chips = read.table(file = "http://www.isi-stats.com/isi2/data/MeltingTimes.txt",
header = TRUE)
chips = read.table(file = "http://www.isi-stats.com/isi2/data/MeltingTimes.txt",
header = TRUE, sep = "\t")
View(chips)
#convert from wide to long
chips
#convert from wide to long
chips %>% gather(key = "type", value = "time", -student)
#convert from wide to long
chips_long = chips %>% gather(key = "type", value = "time", -student)
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
nuts = read.table(file = "http://www.isi-stats.com/isi2/data/pistachioStudySubset.txt",
header = TRUE)
nuts$Temperature = factor(nuts$Temperature)
nuts$AirVelocity = factor(nuts$AirVelocity)
contrasts(nuts$Temperature) = contr.sum
contrasts(nuts$AirVelocity) = contr.sum
nuts = nuts %>% mutate(Treatment = paste(Temperature,"-",AirVelocity,
sep = ""))
summary = nuts %>% group_by(Temperature,AirVelocity) %>%
summarise(meanP = mean(Peroxide), sd(Peroxide), n())
summary
nuts %>% ggplot(aes(x = Treatment, y = Peroxide)) +
geom_boxplot()
summary %>% ggplot(aes(x = Temperature, y = meanP, color = AirVelocity)) +
geom_point()
diffdiff = (summary$meanP[1]-summary$meanP[2]) - (summary$meanP[3]-summary$meanP[4])
#How extreme is this?
m = 5000
nuts.sim = nuts
diffs.sim = c()
for(i in 1:m){
nuts.sim$Peroxide.sim = sample(nuts.sim$Peroxide)
summary.sim = nuts.sim %>%
group_by(Temperature,AirVelocity) %>%
summarise(meanP.sim = mean(Peroxide.sim))
diffs.sim[i] = (summary.sim$meanP.sim[1]-summary.sim$meanP.sim[2]) - (summary.sim$meanP.sim[3]-summary.sim$meanP.sim[4])
}
hist(diffs.sim)
fullModel = lm(Peroxide ~ Temperature*AirVelocity, data = nuts)
summary(fullModel)
anova(fullModel)
summary(mainEffects)
mainEffects = lm(Peroxide ~ Temperature + AirVelocity, data = nuts)
summary(mainEffects)
View(nuts)
nuts = read.table(file = "http://www.isi-stats.com/isi2/data/pistachioStudySubset.txt",
header = TRUE)
nuts$Temperature = factor(nuts$Temperature)
nuts$AirVelocity = factor(nuts$AirVelocity)
contrasts(nuts$Temperature) = contr.sum
contrasts(nuts$AirVelocity) = contr.sum
nuts = nuts %>% mutate(Treatment = paste(Temperature,"-",AirVelocity,
sep = ""))
summary = nuts %>% group_by(Temperature,AirVelocity) %>%
summarise(meanP = mean(Peroxide), sd(Peroxide), n())
summary
mainEffects = lm(Peroxide ~ Temperature + AirVelocity, data = nuts)
summary(mainEffects)
summary %>% ggplot(aes(x = Temperature, y = meanP, color = AirVelocity)) +
geom_point()
#Statistic - difference in differences
diffdiff = (summary$meanP[1]-summary$meanP[2]) - (summary$meanP[3]-summary$meanP[4])
#How extreme is this?
m = 5000
nuts.sim = nuts
diffs.sim = c()
for(i in 1:m){
nuts.sim$Peroxide.sim = sample(nuts.sim$Peroxide)
summary.sim = nuts.sim %>%
group_by(Temperature,AirVelocity) %>%
summarise(meanP.sim = mean(Peroxide.sim))
diffs.sim[i] = (summary.sim$meanP.sim[1]-summary.sim$meanP.sim[2]) - (summary.sim$meanP.sim[3]-summary.sim$meanP.sim[4])
}
hist(diffs.sim)
summary(mainEffects)
summary(lm(Peroxide ~ AirVelocity, data = nuts))
#Statistic - difference in differences
diffdiff = (summary$meanP[1]-summary$meanP[2]) - (summary$meanP[3]-summary$meanP[4])
diffdiff
fullModel = lm(Peroxide ~ Temperature*AirVelocity, data = nuts)
summary(fullModel)
levels(fullModel)
fullModel = lm(Peroxide ~ Temperature*AirVelocity, data = nuts)
levels(fullModel)
summary(fullModel)$levels
fullModel$xlevels
predict(fullModel, nuts)
nuts %>% mutate(predictionFull = predict(fullModel, nuts))
fullModel = lm(Peroxide ~ Temperature*AirVelocity, data = nuts)
summary(fullModel)
anova(fullModel)
fullModel = lm(Peroxide ~ Temperature*AirVelocity, data = nuts)
summary(fullModel)
anova(fullModel)
nuts %>% mutate(predictionFull = predict(fullModel, nuts))
#Statistic - difference in differences
diffdiff = (summary$meanP[1]-summary$meanP[2]) - (summary$meanP[3]-summary$meanP[4])
#How extreme is this?
m = 5000
nuts.sim = nuts
diffs.sim = c()
for(i in 1:m){
nuts.sim$Peroxide.sim = sample(nuts.sim$Peroxide)
summary.sim = nuts.sim %>%
group_by(Temperature,AirVelocity) %>%
summarise(meanP.sim = mean(Peroxide.sim))
diffs.sim[i] = (summary.sim$meanP.sim[1]-summary.sim$meanP.sim[2]) - (summary.sim$meanP.sim[3]-summary.sim$meanP.sim[4])
}
hist(diffs.sim)
summary %>% ggplot(aes(x = Temperature, y = meanP, color = AirVelocity)) +
geom_point()
mainEffects = lm(Peroxide ~ Temperature + AirVelocity, data = nuts)
summary(mainEffects)
nuts = read.table(file = "http://www.isi-stats.com/isi2/data/pistachioStudySubset.txt",
header = TRUE)
nuts$Temperature = factor(nuts$Temperature)
nuts$AirVelocity = factor(nuts$AirVelocity)
contrasts(nuts$Temperature) = contr.sum
contrasts(nuts$AirVelocity) = contr.sum
nuts = nuts %>% mutate(Treatment = paste(Temperature,"-",AirVelocity,
sep = ""))
summary = nuts %>% group_by(Temperature,AirVelocity) %>%
summarise(meanP = mean(Peroxide), sd(Peroxide), n())
summary
nuts %>% ggplot(aes(x = Treatment, y = Peroxide)) +
geom_boxplot()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
nuts = read.table(file = "http://www.isi-stats.com/isi2/data/pistachioStudySubset.txt",
header = TRUE)
fullModel$xlevels
library(tidyverse)
read.table(file = "http://www.isi-stats.com/isi2/data/OJ-n6.txt",
header = TRUE)
orange6 = read.table(file = "http://www.isi-stats.com/isi2/data/OJ-n6.txt",
header = TRUE)
View(orange6)
model6 = lm(VitC ~ Brand*Temp)
model6 = lm(VitC ~ Brand*Temp, data = orange6)
summary(model6)
anova(model6)
orange18 = read.table(file = "http://www.isi-stats.com/isi2/data/OJ-n18.txt",
header = T)
View(model6)
View(orange18)
model18 = lm(VitC ~ Brand*Temp, data = orange18)
summary(model18)
model18 = lm(VitC ~ Brand*Temp, data = orange18)
orange18 = read.table(file = "http://www.isi-stats.com/isi2/data/OJ-n18.txt",
header = T)
model18 = lm(VitC ~ Brand*Temp, data = orange18)
model18 = lm(VitC1000 ~ Brand*Temp, data = orange18)
summary(model18)
anova(model18)
orange6$Brand = factor(orange6$Brand)
contrasts(orange6$Brand) = contr.sum
orange6$Temp = factor(orange6$Temp)
contrasts(orange6$Temp) = contr.sum
orange6 = read.table(file = "http://www.isi-stats.com/isi2/data/OJ-n6.txt",
header = TRUE)
orange6$Brand = factor(orange6$Brand)
contrasts(orange6$Brand) = contr.sum
orange6$Temp = factor(orange6$Temp)
contrasts(orange6$Temp) = contr.sum
model6 = lm(VitC ~ Brand*Temp, data = orange6)
summary(model6)
anova(model6)
orange18 = read.table(file = "http://www.isi-stats.com/isi2/data/OJ-n18.txt",
header = T)
model18 = lm(VitC1000 ~ Brand*Temp, data = orange18)
summary(model18)
anova(model18)
model6 = lm(VitC ~ Brand*Temp, data = orange6)
summary(model6)
anova(model6)
library(tidyverse)
wages_whole = read.table("http://www.isi-stats.com/isi2/data/Wages.txt",
header = TRUE)
#scale wages to match text book
wages$wage = wages$wage/100
#Wages by race
wages %>% ggplot(aes(x = race, y = wage)) + geom_boxplot()
wages_whole = read.table("http://www.isi-stats.com/isi2/data/Wages.txt",
header = TRUE)
wages_whole = read.table("http://www.isi-stats.com/isi2/data/Wages.txt",
header = TRUE)
#Create new variable for binary education and filter unused observations
wages = wages_whole %>% mutate(educ_bin = case_when(educ %in% c("HS","belowHS") ~ "belowCollege",
educ == "beyondCollege" ~ "beyondCollege"))
#scale wages to match text book
wages$wage = wages$wage/100
#Wages by race
wages %>% ggplot(aes(x = race, y = wage)) + geom_boxplot()
adj.lm = lm(wage ~ race + educ_bin, data = wages)
summary(adj.lm)
anova(adj.lm)
summary %>% group_by(race, educ) %>% summarise(meanWage = mean(wage))
summary = wages %>% group_by(race, educ) %>% summarise(meanWage = mean(wage))
summary
summary %>% ggplot(aes(x = educ, y = meanWage, color = race)) + geom_line()
summary %>% ggplot(aes(x = educ, y = meanWage, color = race)) + geom_point()
modelInteration = lm(wage ~ race*educ, data = wages)
summary(modelInteration)
anova(modelInteration)
wages$race = factor(wages$race)
dev.off()
constrasts(wages$race) = contr.sum
constrasts(wages$educ) = contr.sum
constrasts(wages$race) = contr.sum
constrast(wages$race) = contr.sum
contrasts(wages$educ) = contr.sum
contrasts(wages$race) = contr.sum
summary = wages %>% group_by(race, educ) %>%
summarise(meanWage = mean(wage))
summary
summary %>% ggplot(aes(x = educ, y = wage, color = race)) +
geom_point()
summary %>% ggplot(aes(x = educ, y = meanWage, color = race)) +
geom_point()
wages$educ = factor(wages$educ,
levels = c("belowHS",
"HS",
"college",
"beyondCollege"))
summary %>% ggplot(aes(x = educ, y = meanWage, color = race)) +
geom_point()
library(tidyverse)
seeds = read.table(file = "www.isi-stats.com/isi2/data/Polyphenols.txt",
header = T)
seeds = read.table(file = "http://www.isi-stats.com/isi2/data/Polyphenols.txt",
header = T)
View(seeds)
seeds %>% ggplot(aes(x = Ethanol., y = PC )) + geom_point()
seeds %>% ggplot(aes(x = Ethanol., y = PC )) + geom_point() +
geom_smooth(method = "lm")
#Convert Ethanol to a factor
seeds$Ethanol_factor = factor(seeds$Ethanol.)
contrasts(seeds$Ethanol_factor) = contr.sum
modelANOVA = lm(PC ~ Ethanol_factor, data = seeds)
summary(modelANOVA)
xlevels(modelANOVA)
modelANOVA$xlevels
anova(modelANOVA)
modelLinear = lm(PC ~ Ethanol., data = seeds)
summary(modelLinear)
anova(modelLinear)
anova(modelANOVA)
#Observed statistic
coef(modelLinear)[2]
#Observed statistic
slope = coef(modelLinear)[2]
slope.sim = c()
m = 5000
slope = coef(modelLinear)[2]
slope.sim = c()
m = 5000
for(i in 1:m){
seeds$Ethanol.sim = sample(seeds$Ethanol)
modelLinear.sim = lm(PC ~ Ethanol.sim, data = seeds)
slope.sim = coef(modelLinear.sim)[2]
}
hist(slope.sim)
seeds$Ethanol.sim = sample(seeds$Ethanol)
modelLinear.sim = lm(PC ~ Ethanol.sim, data = seeds)
for(i in 1:m){
seeds$Ethanol.sim = sample(seeds$Ethanol)
modelLinear.sim = lm(PC ~ Ethanol.sim, data = seeds)
slope.sim[i] = coef(modelLinear.sim)[2]
}
hist(slope.sim)
summary(modelLinear)
for(i in 1:m){
seeds$PC.sim = sample(seeds$PC)
modelLinear.sim = lm(PC.sim ~ Ethanol, data = seeds)
slope.sim[i] = coef(modelLinear.sim)[2]
}
hist(slope.sim)
for(i in 1:m){
seeds$PC.sim = sample(seeds$PC)
modelLinear.sim = lm(PC.sim ~ Ethanol., data = seeds)
slope.sim[i] = coef(modelLinear.sim)[2]
}
hist(slope.sim)
sum(abs(slope.sim)> slope)/m
wages_whole = read.table("http://www.isi-stats.com/isi2/data/Wages.txt",
header = TRUE)
#Create new variable for binary education and filter unused observations
wages = wages_whole %>% mutate(educ_bin = case_when(educ %in% c("HS","belowHS") ~ "belowCollege",
educ == "beyondCollege" ~ "beyondCollege"))
#scale wages to match text book
wages$wage = wages$wage/100
#Wages by race
wages %>% ggplot(aes(x = race, y = wage)) + geom_boxplot()
wages$race = factor(wages$race)
wages$educ = factor(wages$race)
contrasts(wages$race) = contr.sum
contrasts(wages$educ) = contr.sum
library(tidyverse)
wages_whole = read.table("http://www.isi-stats.com/isi2/data/Wages.txt",
header = TRUE)
#Create new variable for binary education and filter unused observations
wages = wages_whole %>% mutate(educ_bin = case_when(educ %in% c("HS","belowHS") ~ "belowCollege",
educ == "beyondCollege" ~ "beyondCollege"))
#scale wages to match text book
wages$wage = wages$wage/100
#Wages by race
wages %>% ggplot(aes(x = race, y = wage)) + geom_boxplot()
wages$race = factor(wages$race)
wages$educ = factor(wages$race)
contrasts(wages$race) = contr.sum
contrasts(wages$educ) = contr.sum
summary = wages %>% group_by(race, educ) %>%
summarise(meanWage = mean(wage))
summary
wages_whole = read.table("http://www.isi-stats.com/isi2/data/Wages.txt",
header = TRUE)
#Create new variable for binary education and filter unused observations
wages = wages_whole %>% mutate(educ_bin = case_when(educ %in% c("HS","belowHS") ~ "belowCollege",
educ == "beyondCollege" ~ "beyondCollege"))
#scale wages to match text book
wages$wage = wages$wage/100
#Wages by race
wages %>% ggplot(aes(x = race, y = wage)) + geom_boxplot()
wages$race = factor(wages$race)
wages$educ_bin = factor(wages$educ_bin)
contrasts(wages$race) = contr.sum
contrasts(wages$educ_bin) = contr.sum
summary = wages %>% group_by(race, educ) %>%
summarise(meanWage = mean(wage))
summary
summary = wages %>% group_by(race, educ_bin) %>%
summarise(meanWage = mean(wage))
summary
#Create new variable for binary education and filter unused observations
wages = wages_whole %>% mutate(educ_bin = case_when(educ %in% c("HS","belowHS") ~ "belowCollege",
educ == "beyondCollege" ~ "beyondCollege")) %>%
filter(!is.na(educ_bin))
wages$race = factor(wages$race)
wages$educ_bin = factor(wages$educ_bin)
contrasts(wages$race) = contr.sum
contrasts(wages$educ_bin) = contr.sum
#scale wages to match text book
wages$wage = wages$wage/100
summary = wages %>% group_by(race, educ_bin) %>%
summarise(meanWage = mean(wage))
summary
summary(lm(wages ~ race + educ_bin, data = wages))
summary(lm(wage ~ race + educ_bin, data = wages))
mean(summary$meanWage)
summary
(4.18+8.47)/2 - 6.94
(31.8+51.7+34.8+75.8)/4
(31.8+51.7+34.8+75.8)/4 - (31.8+51.7)/2
(31.8+51.7+34.8+75.8)/4 - (31.8+34.8)/2
library(tidyverse)
chocolate = read.table(file = "www.isi-stats.com/isi2/data/MeltingTimes.txt", header = T)
chocolate = read.table(file = "http://www.isi-stats.com/isi2/data/MeltingTimes.txt", header = T)
chocolate = read.table(file = "http://www.isi-stats.com/isi2/data/MeltingTimes.txt", header = T, sep = "\t")
View(chocolate)
chocolate %>% gather()
chocolate %>% gather(-student)
chocolate_long = chocolate %>% gather(-student)
View(chocolate_long)
chocolate_long = chocolate %>% gather(key = "type",
value = "seconds",-student)
View(chocolate_long)
grapes = read.table(file = "www.isi-stats.com/isi2/data/Polyphenols.txt", header = T)
grapes = read.table(file = "http://www.isi-stats.com/isi2/data/Polyphenols.txt", header = T)
View(grapes)
grapes %>% ggplpot(aes(x = Ethanol., y = PC)) + geom_boxplot()
grapes %>% ggplot(aes(x = Ethanol., y = PC)) + geom_boxplot()
grapes %>% ggplot(aes(x = factor(Ethanol.), y = PC)) + geom_boxplot()
grapes$Ethanol_cat = factor(grapes$Ethanol.)
contrasts(grapes$Ethanol_cat) = contr.sum
model_anova = lm(PC ~ Ethanol_cat, data = grapes)
summary(model_anova)
anova(model_anova)
model_regression = lm(PC ~ Ethanol., data = grapes)
summary(model_regression)
anova(model_regression)
summary(model_regression)
grapes = read.table(file = "http://www.isi-stats.com/isi2/data/Polyphenols.txt", header = T)
grapes %>% ggplot(aes(x = factor(Ethanol.), y = PC)) + geom_boxplot()
grapes %>% ggplot(aes(x = Ethanol., y = PC)) + geom_boxplot()
library(tidyverse)
grapes %>% ggplot(aes(x = factor(Ethanol.), y = PC)) + geom_boxplot()
grapes %>% ggplot(aes(x = Ethanol., y = PC)) + geom_boxplot()
grapes %>% ggplot(aes(x = Ethanol., y = PC)) + geom_point()
grapes = read.table(file = "http://www.isi-stats.com/isi2/data/Polyphenols.txt", header = T)
grapes %>% ggplot(aes(x = Ethanol., y = PC)) + geom_point()
grapes$Ethanol_cat = factor(grapes$Ethanol.)
contrasts(grapes$Ethanol_cat) = contr.sum
model_anova = lm(PC ~ Ethanol_cat, data = grapes)
summary(model_anova)
anova(model_anova)
model_regression = lm(PC ~ Ethanol., data = grapes)
summary(model_regression)
anova(model_regression)
m = 5000 #number of iterations
slopes = c() # empty vector
grapes.sim = grapes #copy of data
for(i in 1:m){
grapes.sim$PC.sim = sample(grapes.sim$PC) #shuffle the response
model.sim = lm(PC.sim ~ Ethanol., data = grapes.sim) # fit model to shuffled data
slopes[i] = coef(model.sim)[2] # extract the slope from the model
}
hist(slopes)
sum(slopes > coef(model_regression)[2])/m
summary(model_regression)
names(model_regression)
names(summary(model_regression))
coef(model_regression)
summary(model_regression)$coefficients
b1 = summary(model_regression)$coefficients[2,2]
b1 = summary(model_regression)$coefficients[2,1]
b1 = summary(model_regression)$coefficients[2,1]
se_b1 = summary(model_regression)$coefficients[2,2]
tstar = qt(0.975,13)
tstar = qt(0.975,13)
upper = b1 + tstar * se_b1
lower = b1 - tstar * se_b1
# or you can just do
confint(model_regression)
